# Save a robust version of index_complete.html that includes a no-blank fallback
html = r"""<!DOCTYPE html>
<html lang="en" x-data="appData()" x-init="init()" :data-theme="theme">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>India's Economic Paradox: Growth Without Accountability (2004-2025)</title>

  <!-- Libs (will enhance if network allows) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { darkMode: 'class' }</script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

  <style>
    :root{
      --bg-primary:#fff; --bg-secondary:#f9fafb; --bg-card:#fff;
      --text-primary:#111827; --text-secondary:#4b5563; --text-muted:#9ca3af;
      --border-color:#e5e7eb; --shadow-color:rgba(0,0,0,.1);
      --accent-purple:#7C3AED; --chart-bg:#fff; --nav-bg:#fff;
    }
    [data-theme="dark"]{
      --bg-primary:#0f172a; --bg-secondary:#1e293b; --bg-card:#334155;
      --text-primary:#f1f5f9; --text-secondary:#cbd5e1; --text-muted:#94a3b8;
      --border-color:#475569; --shadow-color:rgba(0,0,0,.5);
      --chart-bg:#1e293b; --nav-bg:#1e293b;
    }
    body{background:var(--bg-secondary);color:var(--text-primary);transition:.3s ease}
    .dark-card{background:var(--bg-card);color:var(--text-primary)}
    .dark-nav{background:var(--nav-bg)}
    .dark-text-primary{color:var(--text-primary)} .dark-text-secondary{color:var(--text-secondary)}
    .dark-border{border-color:var(--border-color)}
    .tab-active{border-bottom:3px solid var(--accent-purple); color:var(--accent-purple)}
    .audience-active{background:var(--accent-purple)!important;color:#fff!important;border-color:var(--accent-purple)!important}
    .export-buttons{position:absolute;top:.5rem;right:.5rem;display:flex;gap:.375rem;opacity:.25;transition:.2s}
    .chart-wrapper:hover .export-buttons{opacity:1}
    [x-cloak]{display:none!important}
    .chart-container{position:relative;width:100%;background:var(--chart-bg);padding:.5rem;border-radius:.5rem;height:260px}
    @media (min-width:768px){ .chart-container{height:350px} }
    .chart-container-small{position:relative;width:100%;background:var(--chart-bg);padding:.5rem;border-radius:.5rem;height:220px}
    @media (min-width:768px){ .chart-container-small{height:260px} }
    .spark{height:56px;width:100%;}
    .table-wrapper{overflow:auto;-webkit-overflow-scrolling:touch}
    .theme-toggle{position:fixed;bottom:14px;right:14px;z-index:90;background:var(--accent-purple);color:#fff;width:46px;height:46px;border-radius:9999px;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 20px var(--shadow-color)}
    @media print{ .no-print{display:none!important} body{background:#fff!important;color:#000!important} }
    /* Tiny no-JS fallback so page isn't ugly if Tailwind is blocked */
    .nojs-note{display:none}
    .nojs body{font-family:system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica Neue, Arial}
    .nojs .nojs-note{display:block;padding:.5rem .75rem;background:#f97316;color:#111827;font-size:.875rem}
    .nojs .container{max-width:72rem;margin:0 auto;padding:1rem}
    .nojs .card{background:#fff;border:1px solid #e5e7eb;border-radius:.5rem;padding:1rem;margin:.75rem 0}
  </style>
  <script>
    // If Tailwind fails to load (offline/CSP), add a minimal "nojs" class for readable fallback
    (function(){
      var fired=false;
      setTimeout(function(){
        if (typeof window.tailwind === 'undefined') {
          document.documentElement.classList.add('nojs');
        }
      }, 800);
    })();
  </script>
</head>
<body class="min-h-screen flex flex-col">

  <div class="nojs-note">‚ö†Ô∏è Interactive features may be limited (network blocked or offline). Content shown in fallback mode.</div>

  <!-- Theme toggle -->
  <button @click="toggleTheme()" class="theme-toggle no-print" :title="theme==='light'?'Dark mode':'Light mode'">
    <svg x-show="theme==='light'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1111.21 3a7 7 0 109.79 9.79z"/></svg>
    <svg x-show="theme==='dark'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v2m0 14v2m7-9h2M3 12H1m15.364 6.364l1.414 1.414M4.222 4.222L5.636 5.636m12.728 0l1.414-1.414M4.222 19.778l1.414-1.414"/></svg>
  </button>

  <!-- Top notice/download bar (kept) -->
  <div class="bg-purple-900 text-white py-2 px-3 sm:px-4 no-print">
    <div class="max-w-7xl mx-auto flex flex-col sm:flex-row gap-1 sm:gap-4 justify-between items-start sm:items-center text-[13px]">
      <span>üìä Evidence-based research on India's economic transformation</span>
      <div class="flex gap-3 flex-wrap">
        <a href="#" @click.prevent="downloadPaper()" class="underline underline-offset-2">üìÑ Paper (PDF)</a>
        <a href="#" @click.prevent="downloadData()" class="underline underline-offset-2">üìà Data (Excel)</a>
        <a href="#" @click.prevent="downloadCode()" class="underline underline-offset-2">üíª Code (GitHub)</a>
      </div>
    </div>
  </div>

  <!-- Sticky Nav -->
  <div class="dark-nav shadow sticky top-0 z-40 no-print">
    <div class="max-w-7xl mx-auto px-3 sm:px-4 py-3">
      <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-2 mb-2">
        <div>
          <h1 class="text-xl sm:text-2xl font-bold dark-text-primary leading-tight">India's Two Decades: A Tale of Two Models</h1>
          <p class="text-xs dark-text-secondary">UPA (2004‚Äì2014) vs NDA (2014‚Äì2025)</p>
        </div>
        <div class="flex items-center gap-2">
          <label class="text-xs sm:text-sm dark-text-secondary font-medium">I am a:</label>
          <div class="flex gap-1 sm:gap-2">
            <button @click="setAudience('academic')" :class="audienceType==='academic'?'audience-active':'dark-card dark-border'" class="px-2 py-1 sm:px-3 rounded border text-xs">Researcher</button>
            <button @click="setAudience('policy')" :class="audienceType==='policy'?'audience-active':'dark-card dark-border'" class="px-2 py-1 sm:px-3 rounded border text-xs">Policy</button>
            <button @click="setAudience('journalist')" :class="audienceType==='journalist'?'audience-active':'dark-card dark-border'" class="px-2 py-1 sm:px-3 rounded border text-xs">Journalist</button>
            <button @click="setAudience('general')" :class="audienceType==='general'?'audience-active':'dark-card dark-border'" class="px-2 py-1 sm:px-3 rounded border text-xs">Citizen/Student</button>
          </div>
        </div>
      </div>

      <div class="flex space-x-5 border-t dark-border pt-2 overflow-x-auto no-scrollbar text-sm">
        <button @click="activeTab='about'"        :class="activeTab==='about'?'tab-active':''"        class="pb-2 px-1 whitespace-nowrap">What is This?</button>
        <button @click="activeTab='summary'"      :class="activeTab==='summary'?'tab-active':''"      class="pb-2 px-1 whitespace-nowrap">Executive Summary</button>
        <button @click="activeTab='findings'"     :class="activeTab==='findings'?'tab-active':''"     class="pb-2 px-1 whitespace-nowrap">Key Findings</button>
        <button @click="activeTab='data'"         :class="activeTab==='data'?'tab-active':''"         class="pb-2 px-1 whitespace-nowrap">Interactive Data</button>
        <button @click="activeTab='indices'"      :class="activeTab==='indices'?'tab-active':''"      class="pb-2 px-1 whitespace-nowrap">Three Indices</button>
        <button @click="activeTab='methods'"      :class="activeTab==='methods'?'tab-active':''"      class="pb-2 px-1 whitespace-nowrap">Methodology</button>
        <button @click="activeTab='glossary'"     :class="activeTab==='glossary'?'tab-active':''"     class="pb-2 px-1 whitespace-nowrap">Glossary</button>
        <button @click="activeTab='implications'" :class="activeTab==='implications'?'tab-active':''" class="pb-2 px-1 whitespace-nowrap">Implications</button>
        <button @click="activeTab='whatnext'"     :class="activeTab==='whatnext'?'tab-active':''"     class="pb-2 px-1 whitespace-nowrap">What Next?</button>
      </div>
    </div>
  </div>

  <!-- Main -->
  <main class="max-w-7xl mx-auto px-3 sm:px-4 py-6 sm:py-8 flex-grow">

    <div x-show="audienceType" x-cloak class="mb-4 sm:mb-6">
      <div class="bg-purple-50 dark:bg-purple-900/20 border-l-4 border-purple-600 p-4 sm:p-5 rounded dark-card">
        <div class="grid md:grid-cols-5 gap-4">
          <div class="md:col-span-3 text-sm dark-text-primary" x-html="getAudiencePanel()"></div>
          <div class="md:col-span-2">
            <div class="text-xs font-semibold mb-2 dark-text-primary">Quick Notes</div>
            <ul class="text-xs dark-text-secondary space-y-1" x-html="getAudienceQuickNotes()"></ul>
          </div>
        </div>
      </div>
    </div>

    <!-- ABOUT -->
    <div x-show="activeTab==='about'">
      <section class="dark-card rounded-lg shadow p-4 sm:p-6 mb-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-3 dark-text-primary">Welcome</h2>
        <p class="text-sm sm:text-base dark-text-secondary">This companion site showcases the evidence behind the paper <strong>‚ÄúNarratives, Numbers, and Democratic Accountability: A Political Economy Assessment of India, 2014‚Äì2025.‚Äù</strong></p>
        <div class="grid md:grid-cols-2 gap-4 sm:gap-6 mt-4">
          <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded">
            <h4 class="font-semibold mb-2 dark-text-primary">What‚Äôs Unique</h4>
            <ul class="text-sm dark-text-secondary space-y-1">
              <li>‚Ä¢ 20 years of comparable series</li>
              <li>‚Ä¢ Three original institutional indices</li>
              <li>‚Ä¢ Triangulated official & survey data</li>
            </ul>
          </div>
          <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded">
            <h4 class="font-semibold mb-2 dark-text-primary">Questions We Answer</h4>
            <ul class="text-sm dark-text-secondary space-y-1">
              <li>‚Ä¢ Why didn‚Äôt growth deliver secure jobs?</li>
              <li>‚Ä¢ How did inequality surpass colonial peaks?</li>
              <li>‚Ä¢ What changed in statistics & federal finance?</li>
            </ul>
          </div>
        </div>
      </section>
    </div>

    <!-- EXECUTIVE SUMMARY -->
    <div x-show="activeTab==='summary'" x-cloak>
      <section class="grid sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-4 sm:mb-6">
        <div class="dark-card rounded shadow p-4"><div class="text-xs dark-text-secondary">GDP Growth Avg</div><div class="text-lg font-bold text-blue-600">UPA 7.7%</div><div class="text-lg font-bold text-red-600">NDA 6.8%</div></div>
        <div class="dark-card rounded shadow p-4"><div class="text-xs dark-text-secondary">Top 1% Income Share</div><div class="text-lg font-bold text-blue-600">UPA ~15%</div><div class="text-lg font-bold text-red-600">NDA ~22.6%</div></div>
        <div class="dark-card rounded shadow p-4"><div class="text-xs dark-text-secondary">Press Freedom Rank</div><div class="text-lg font-bold text-blue-600">~105‚Äì140</div><div class="text-lg font-bold text-red-600">~140‚Äì161</div></div>
        <div class="dark-card rounded shadow p-4"><div class="text-xs dark-text-secondary">Formal Employment</div><div class="text-lg font-bold text-blue-600">~18%</div><div class="text-lg font-bold text-red-600">~11%</div></div>
      </section>

      <section class="dark-card rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-3 dark-text-primary">The Core Finding</h2>
        <div x-html="getSummaryContent()" class="prose max-w-none text-sm sm:text-base dark-text-secondary"></div>
        <div class="chart-wrapper relative mt-4">
          <div class="export-buttons">
            <button onclick="exportChart('summaryChart','png')" class="bg-blue-500 text-white px-2 py-1 rounded text-xs">PNG</button>
            <button onclick="exportChart('summaryChart','csv')" class="bg-green-500 text-white px-2 py-1 rounded text-xs">CSV</button>
          </div>
          <div class="chart-container"><canvas id="summaryChart"></canvas></div>
        </div>
        <p class="text-[12px] mt-2 dark-text-secondary">Formal Employment plotted on right axis. Lower rank = better in Press metric.</p>
      </section>
    </div>

    <!-- KEY FINDINGS -->
    <div x-show="activeTab==='findings'" x-cloak>
      <section class="space-y-4 sm:space-y-6">
        <div class="dark-card rounded-lg shadow p-4 sm:p-6">
          <h3 class="text-lg sm:text-xl font-bold mb-3 dark-text-primary">Finding 1: Jobs Transformed, Not Created</h3>
          <div class="grid md:grid-cols-2 gap-4 sm:gap-6">
            <div x-html="getEmploymentFindings()" class="text-sm dark-text-secondary"></div>
            <div class="chart-wrapper relative">
              <div class="export-buttons">
                <button onclick="exportChart('employmentChart','png')" class="bg-blue-500 text-white px-2 py-1 rounded text-xs">PNG</button>
                <button onclick="exportChart('employmentChart','csv')" class="bg-green-500 text-white px-2 py-1 rounded text-xs">CSV</button>
              </div>
              <div class="chart-container-small"><canvas id="employmentChart"></canvas></div>
            </div>
          </div>
        </div>
        <div class="dark-card rounded-lg shadow p-4 sm:p-6">
          <h3 class="text-lg sm:text-xl font-bold mb-3 dark-text-primary">Finding 2: Inequality Exceeds Colonial-Era Levels</h3>
          <div class="grid md:grid-cols-2 gap-4 sm:gap-6">
            <div class="chart-wrapper relative">
              <div class="export-buttons">
                <button onclick="exportChart('inequalityChart','png')" class="bg-blue-500 text-white px-2 py-1 rounded text-xs">PNG</button>
                <button onclick="exportChart('inequalityChart','csv')" class="bg-green-500 text-white px-2 py-1 rounded text-xs">CSV</button>
              </div>
              <div class="chart-container-small"><canvas id="inequalityChart"></canvas></div>
            </div>
            <div x-html="getInequalityFindings()" class="text-sm dark-text-secondary"></div>
          </div>
        </div>
      </section>
    </div>

    <!-- INTERACTIVE DATA -->
    <div x-show="activeTab==='data'" x-cloak>
      <section class="dark-card rounded-lg shadow p-4 sm:p-6 mb-4 sm:mb-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-3 dark-text-primary">Interactive Data Explorer</h2>

        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3">
          <div>
            <label class="text-[12px] dark-text-secondary">Primary</label>
            <select class="w-full p-2 border rounded dark-border" x-model="dataCfg.metric" @change="renderExplorer()">
              <option value="gdp">GDP Growth %</option>
              <option value="top1">Top 1% Income Share %</option>
              <option value="formal">Formal Employment %</option>
              <option value="informal">Informal/Gig %</option>
              <option value="press">Press Freedom Rank</option>
            </select>
          </div>
          <div>
            <label class="text-[12px] dark-text-secondary">Compare</label>
            <select class="w-full p-2 border rounded dark-border" x-model="dataCfg.compare1" @change="renderExplorer()">
              <option value="">None</option>
              <option value="gdp">GDP Growth %</option>
              <option value="top1">Top 1% Income Share %</option>
              <option value="formal">Formal Employment %</option>
              <option value="informal">Informal/Gig %</option>
              <option value="press">Press Freedom Rank</option>
            </select>
          </div>
          <div>
            <label class="text-[12px] dark-text-secondary">+ Another</label>
            <select class="w-full p-2 border rounded dark-border" x-model="dataCfg.compare2" @change="renderExplorer()">
              <option value="">None</option>
              <option value="gdp">GDP Growth %</option>
              <option value="top1">Top 1% Income Share %</option>
              <option value="formal">Formal Employment %</option>
              <option value="informal">Informal/Gig %</option>
              <option value="press">Press Freedom Rank</option>
            </select>
          </div>
          <div>
            <label class="text-[12px] dark-text-secondary">Type</label>
            <select class="w-full p-2 border rounded dark-border" x-model="dataCfg.type" @change="renderExplorer()">
              <option value="line">Line</option>
              <option value="bar">Bar</option>
              <option value="area">Area</option>
            </select>
          </div>
          <div>
            <label class="text-[12px] dark-text-secondary">Years</label>
            <div class="flex items-center gap-2">
              <input type="number" class="w-full p-2 border rounded dark-border" x-model.number="dataCfg.start" @change="renderExplorer()">
              <span class="text-xs dark-text-secondary">‚Üí</span>
              <input type="number" class="w-full p-2 border rounded dark-border" x-model.number="dataCfg.end" @change="renderExplorer()">
            </div>
            <label class="inline-flex items-center gap-2 mt-2">
              <input type="checkbox" class="rounded" x-model="dataCfg.showRegimes" @change="renderExplorer()">
              <span class="text-[12px] dark-text-secondary">UPA/NDA shading</span>
            </label>
          </div>
        </div>

        <div class="chart-wrapper relative mt-3">
          <div class="export-buttons">
            <button @click="exportExplorer('png')" class="bg-blue-500 text-white px-2 py-1 rounded text-xs">PNG</button>
            <button @click="exportExplorer('csv')" class="bg-green-500 text-white px-2 py-1 rounded text-xs">CSV</button>
          </div>
          <div class="chart-container"><canvas id="dataExplorerChart"></canvas></div>
        </div>
      </section>

      <section class="dark-card rounded-lg shadow p-4 sm:p-6">
        <h3 class="text-base sm:text-lg font-semibold mb-2 dark-text-primary">Visible Data (current selection)</h3>
        <div class="table-wrapper">
          <table class="min-w-full text-sm">
            <thead>
              <tr class="text-left">
                <th class="px-3 py-2 border-b dark-border">Year</th>
                <th class="px-3 py-2 border-b dark-border" x-text="metricLabel(dataCfg.metric)"></th>
                <th class="px-3 py-2 border-b dark-border" x-text="dataCfg.compare1?metricLabel(dataCfg.compare1):''"></th>
                <th class="px-3 py-2 border-b dark-border" x-text="dataCfg.compare2?metricLabel(dataCfg.compare2):''"></th>
              </tr>
            </thead>
            <tbody>
              <template x-for="row in visibleDataRows" :key="row.year">
                <tr>
                  <td class="px-3 py-2 border-b dark-border" x-text="row.year"></td>
                  <td class="px-3 py-2 border-b dark-border" x-text="row.v1"></td>
                  <td class="px-3 py-2 border-b dark-border" x-text="row.v2 ?? ''"></td>
                  <td class="px-3 py-2 border-b dark-border" x-text="row.v3 ?? ''"></td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </section>
    </div>

    <!-- INDICES -->
    <div x-show="activeTab==='indices'" x-cloak>
      <section class="dark-card rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-3 dark-text-primary">Three Indices</h2>
        <div class="grid md:grid-cols-3 gap-4 sm:gap-6">
          <div class="dark-card rounded border dark-border p-4">
            <h4 class="font-semibold mb-2">SSI</h4>
            <div class="chart-wrapper relative">
              <div class="export-buttons">
                <button onclick="exportChart('ssiChart','png')" class="bg-blue-500 text-white px-2 py-1 rounded text-xs">PNG</button>
                <button onclick="exportChart('ssiChart','csv')" class="bg-green-500 text-white px-2 py-1 rounded text-xs">CSV</button>
              </div>
              <div class="chart-container-small"><canvas id="ssiChart"></canvas></div>
            </div>
            <p class="text-[12px] mt-2 dark-text-secondary">Higher = more suppression (0‚Äì10).</p>
          </div>
          <div class="dark-card rounded border dark-border p-4">
            <h4 class="font-semibold mb-2">FCI</h4>
            <div class="chart-wrapper relative">
              <div class="export-buttons">
                <button onclick="exportChart('fciChart','png')" class="bg-blue-500 text-white px-2 py-1 rounded text-xs">PNG</button>
                <button onclick="exportChart('fciChart','csv')" class="bg-green-500 text-white px-2 py-1 rounded text-xs">CSV</button>
              </div>
              <div class="chart-container-small"><canvas id="fciChart"></canvas></div>
            </div>
            <p class="text-[12px] mt-2 dark-text-secondary">Share of centralised revenues/controls (0‚Äì1).</p>
          </div>
          <div class="dark-card rounded border dark-border p-4">
            <h4 class="font-semibold mb-2">DQI</h4>
            <div class="chart-wrapper relative">
              <div class="export-buttons">
                <button onclick="exportChart('dqiChart','png')" class="bg-blue-500 text-white px-2 py-1 rounded text-xs">PNG</button>
                <button onclick="exportChart('dqiChart','csv')" class="bg-green-500 text-white px-2 py-1 rounded text-xs">CSV</button>
              </div>
              <div class="chart-container-small"><canvas id="dqiChart"></canvas></div>
            </div>
            <p class="text:[12px] mt-2 dark-text-secondary">Higher is better (0‚Äì1).</p>
          </div>
        </div>
      </section>
    </div>

    <!-- METHODS -->
    <div x-show="activeTab==='methods'" x-cloak>
      <section class="dark-card rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-3 dark-text-primary">Methodology (Brief)</h2>
        <div class="grid md:grid-cols-3 gap-4 sm:gap-6 text-sm dark-text-secondary">
          <div><h4 class="font-semibold mb-2 dark-text-primary">Data</h4><ul class="space-y-1"><li>‚Ä¢ National Accounts; ASI</li><li>‚Ä¢ PLFS/CMIE</li><li>‚Ä¢ Tax (cess/surcharge)</li><li>‚Ä¢ RBI BoP/FDI</li><li>‚Ä¢ Press freedom & governance</li></ul></div>
          <div><h4 class="font-semibold mb-2 dark-text-primary">Estimands</h4><ul class="space-y-1"><li>‚Ä¢ Employment elasticity</li><li>‚Ä¢ Top 1% share</li><li>‚Ä¢ Fiscal centralisation</li><li>‚Ä¢ SSI, FCI, DQI</li></ul></div>
          <div><h4 class="font-semibold mb-2 dark-text-primary">Robustness</h4><ul class="space-y-1"><li>‚Ä¢ Base-year sensitivity</li><li>‚Ä¢ Alt. weights/components</li><li>‚Ä¢ Pre-trend checks</li><li>‚Ä¢ External validation</li></ul></div>
        </div>
      </section>
    </div>

    <!-- GLOSSARY -->
    <div x-show="activeTab==='glossary'" x-cloak>
      <section class="dark-card rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-3 dark-text-primary">Glossary</h2>
        <div class="table-wrapper">
          <table class="min-w-full text-sm">
            <thead>
              <tr class="text-left">
                <th class="px-3 py-2 border-b dark-border">Term</th>
                <th class="px-3 py-2 border-b dark-border">Plain-English Meaning</th>
                <th class="px-3 py-2 border-b dark-border">Example</th>
              </tr>
            </thead>
            <tbody class="align-top">
              <tr><td class="px-3 py-2 border-b dark-border font-medium">GDP growth (%)</td><td class="px-3 py-2 border-b dark-border">How fast the economy grows each year.</td><td class="px-3 py-2 border-b dark-border">‚Çπ100 ‚Üí ‚Çπ107 ‚áí ~7%.</td></tr>
              <tr><td class="px-3 py-2 border-b dark-border font-medium">Formal employment</td><td class="px-3 py-2 border-b dark-border">Jobs with contracts/benefits.</td><td class="px-3 py-2 border-b dark-border">Factory worker with PF vs gig rider.</td></tr>
              <tr><td class="px-3 py-2 border-b dark-border font-medium">Informal/Gig</td><td class="px-3 py-2 border-b dark-border">Temp/daily-wage/app-based work.</td><td class="px-3 py-2 border-b dark-border">Ride-share driver; shop helper.</td></tr>
              <tr><td class="px-3 py-2 border-b dark-border font-medium">Top 1% income share</td><td class="px-3 py-2 border-b dark-border">Slice of income to richest 1%.</td><td class="px-3 py-2 border-b dark-border">If total ‚Çπ100; top 1% ‚Çπ22 ‚áí 22%.</td></tr>
              <tr><td class="px-3 py-2 border-b dark-border font-medium">Press Freedom rank</td><td class="px-3 py-2 border-b dark-border">Lower rank means freer media.</td><td class="px-3 py-2 border-b dark-border">105 is freer than 150.</td></tr>
              <tr><td class="px-3 py-2 border-b dark-border font-medium">Cess/Surcharge</td><td class="px-3 py-2 border-b dark-border">Taxes kept by Centre, not shared.</td><td class="px-3 py-2 border-b dark-border">Education cess on income tax.</td></tr>
              <tr><td class="px-3 py-2 border-b dark-border font-medium">SSI / FCI / DQI</td><td class="px-3 py-2 border-b dark-border">Institutional indices (see Methods).</td><td class="px-3 py-2 border-b dark-border">Suppression ‚Üë ‚áí SSI ‚Üë.</td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </div>

    <!-- IMPLICATIONS -->
    <div x-show="activeTab==='implications'" x-cloak>
      <section class="dark-card rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-3 dark-text-primary">Implications</h2>
        <div class="grid md:grid-cols-3 gap-4 sm:gap-6 text-sm dark-text-secondary">
          <div><h4 class="font-semibold mb-1 text-red-600">Economic</h4><ul class="space-y-1"><li>‚Ä¢ Weak job creation</li><li>‚Ä¢ Demand fragility</li><li>‚Ä¢ Investment uncertainty</li></ul></div>
          <div><h4 class="font-semibold mb-1 text-blue-600">Federal</h4><ul class="space-y-1"><li>‚Ä¢ States constrained</li><li>‚Ä¢ Less for health/education</li><li>‚Ä¢ GST tensions</li></ul></div>
          <div><h4 class="font-semibold mb-1 text-green-600">Democratic</h4><ul class="space-y-1"><li>‚Ä¢ Media plurality shrinks</li><li>‚Ä¢ Lower transparency</li><li>‚Ä¢ Weaker citizen voice</li></ul></div>
        </div>
      </section>
    </div>

    <!-- WHAT NEXT -->
    <div x-show="activeTab==='whatnext'" x-cloak>
      <section class="dark-card rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-3 dark-text-primary">What Next?</h2>
        <p class="text-sm dark-text-secondary">Scenarios and actions (unchanged structure).</p>
      </section>
    </div>

  </main>

  <footer class="bg-gray-800 text-white mt-10 no-print">
    <div class="max-w-7xl mx-auto px-3 sm:px-4 py-8">
      <div class="grid md:grid-cols-3 gap-6">
        <div>
          <h4 class="font-bold mb-3">About This Research</h4>
          <p class="text-sm text-gray-400">Independent, evidence-based analysis of India's economic transformation.</p>
          <div class="mt-3 flex flex-wrap gap-3 text-sm">
            <a href="#" @click.prevent="downloadPaper()" class="text-blue-300 underline">Full Paper (PDF)</a>
            <a href="#" @click.prevent="downloadData()" class="text-blue-300 underline">Dataset (Excel)</a>
            <a href="https://github.com/someperspective/india-economy" class="text-blue-300 underline">Code (GitHub)</a>
          </div>
        </div>
        <div>
          <h4 class="font-bold mb-3">Legal Disclaimer</h4>
          <p class="text-xs text-gray-400">Educational use only. Views represent independent academic research based on publicly available data.</p>
          <p class="text-xs text-gray-400 mt-2"><strong>Compliance:</strong> IT Act, 2000 compliant. No sensitive personal data collected.</p>
        </div>
        <div>
          <h4 class="font-bold mb-3">License & Usage</h4>
          <p class="text-sm text-gray-400">Released under <a href="https://opensource.org/licenses/MIT" class="underline">MIT License</a></p>
          <p class="text-xs text-gray-400 mt-2">Permission to use, copy, modify, and distribute with attribution.</p>
          <p class="text-xs text-gray-400 mt-3"><strong>Citation:</strong> Raman, V.S. (2025). India's Economic Paradox: Growth Without Accountability. someperspective.info</p>
        </div>
      </div>
      <div class="border-t border-gray-700 mt-6 pt-3 text-center text-xs text-gray-500">
        ¬© 2025 Some Perspective ‚Ä¢ <a href="#" onclick="window.print()" class="underline">Print</a> ‚Ä¢ <a href="mailto:research@someperspective.info" class="underline">Contact</a>
      </div>
    </div>
  </footer>

  <!-- No-blank fallback: uncloak if Alpine/Chart are blocked -->
  <div id="cdn-fallback-note" style="display:none;position:sticky;bottom:0;z-index:9999;background:#f97316;color:#111827;padding:.5rem .75rem;font-size:.875rem" class="no-print">
    ‚ö†Ô∏è Interactive features are unavailable (network blocked/offline). Content is shown in fallback mode.
  </div>
  <script>
  (function () {
    function uncloakAll() {
      document.querySelectorAll('[x-cloak]').forEach(el => el.removeAttribute('x-cloak'));
      var n=document.getElementById('cdn-fallback-note'); if(n) n.style.display='block';
      console.warn('Fallback active: CDN libraries not detected. Showing content without interactivity.');
    }
    window.addEventListener('load', function () {
      setTimeout(function () {
        if (!window.Alpine || !window.Chart) uncloakAll();
      }, 900);
    });
  })();
  </script>

  <script>
    function appData(){
      return {
        theme: localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'),
        activeTab:'summary',
        audienceType:'',
        charts:{}, sparks:{},

        setAudience(t){ this.audienceType=t; setTimeout(()=>{ this.buildSparklines(); }, 0); },
        toggleTheme(){
          this.theme=this.theme==='light'?'dark':'light';
          localStorage.setItem('theme',this.theme);
          document.documentElement.classList.toggle('dark', this.theme==='dark');
          this.rebuildCharts(); this.buildSparklines();
        },

        init(){
          document.documentElement.classList.toggle('dark', this.theme==='dark');
          try{ if (window['chartjs-plugin-annotation']) Chart.register(window['chartjs-plugin-annotation']); }catch(e){}
          setTimeout(()=>{ this.buildSummary(); this.buildEmployment(); this.buildInequality(); this.buildIndices(); this.renderExplorer(); }, 60);
        },

        rebuildCharts(){
          for(const k in this.charts){ try{ this.charts[k].destroy(); }catch(e){} }
          this.buildSummary(); this.buildEmployment(); this.buildInequality(); this.buildIndices(); this.renderExplorer();
        },

        getAudiencePanel(){
          const journalist = `
            <h3 class="font-semibold mb-1">Journalists: 90-second brief</h3>
            <p>GDP grew across both regimes, but <strong>formal jobs shrank</strong> and the <strong>top 1% share rose to ~22.6%</strong>. Institutions shifted: statistics became <em>slower/thinner</em> (SSI‚Üë), Centre‚Äôs fiscal grip <em>tightened</em> (FCI‚Üë), and democratic quality <em>weakened</em> (DQI‚Üì).</p>
            <div class="grid grid-cols-2 gap-3 my-3">
              <div class="dark-card border dark-border rounded p-2">
                <div class="text-[11px] dark-text-secondary mb-1">Top 1% share ‚Üë</div>
                <canvas id="spark1" class="spark"></canvas>
              </div>
              <div class="dark-card border dark-border rounded p-2">
                <div class="text-[11px] dark-text-secondary mb-1">Formal employment ‚Üì</div>
                <canvas id="spark2" class="spark"></canvas>
              </div>
            </div>
            <h4 class="font-semibold mt-2 mb-1">Angles & nut-grafs</h4>
            <ul class="list-disc ml-5">
              <li><em>Growth without jobs:</em> Why secure work lagged.</li>
              <li><em>Concentration at the top:</em> Who benefitted from growth.</li>
              <li><em>Data vacuum:</em> When revisions and gaps shape the story.</li>
            </ul>
          `;
          const students = `
            <h3 class="font-semibold mb-1">Students/Citizens: simple explanations</h3>
            <p><strong>GDP growth</strong> is like your school adding more rooms; <strong>formal jobs</strong> are full-time teachers with benefits; <strong>gig work</strong> is a substitute teacher called when needed.</p>
            <h4 class="font-semibold mt-3 mb-1">Worked examples</h4>
            <ol class="list-decimal ml-5 space-y-1">
              <li><strong>Elasticity:</strong> If GDP grows 6% and elasticity is 0.5, jobs grow ‚âà 3%. If elasticity drops to 0.1, jobs grow ‚âà 0.6%.</li>
              <li><strong>Top 1% share:</strong> Total income ‚Çπ1,000; top 1% take 22% ‚áí ‚Çπ220. If it rises to 25%, their share becomes ‚Çπ250.</li>
              <li><strong>Formal vs informal:</strong> Workforce 50 crore. Formal 11% ‚áí 5.5 crore; informal 89% ‚áí 44.5 crore.</li>
            </ol>
          `;
          const policy = `
            <h3 class="font-semibold mb-1">Policy makers: one-page brief</h3>
            <p><strong>Binding constraints:</strong> (1) Job quality; (2) Fiscal space for States; (3) Statistical credibility.</p>
            <ul class="list-disc ml-5">
              <li><strong>Levers:</strong> Labour-intensive manufacturing/services; cap cesses; independent statistics; gig-worker insurance.</li>
              <li><strong>Metrics to watch:</strong> Formal share ‚Üë, wage growth median ‚Üë, cesses share ‚Üì, release lags ‚Üì.</li>
            </ul>
          `;
          const academic = `
            <h3 class="font-semibold mb-1">Researchers: replication pointers</h3>
            <ul class="list-disc ml-5">
              <li>Employment: stitched PLFS/CMIE for composition; elasticity over sub-periods.</li>
              <li>Inequality: spliced top 1% series; robustness to base-year changes.</li>
              <li>Indices: SSI/FCI/DQI via PCA + rescaling; component notes in Methods.</li>
            </ul>
          `;
          switch(this.audienceType){
            case 'journalist': return journalist;
            case 'general': return students;
            case 'policy': return policy;
            case 'academic': return academic;
            default: return '';
          }
        },
        getAudienceQuickNotes(){
          const notes = {
            journalist:`<li>Export PNG/CSV from any chart.</li><li>Lower press rank = better.</li><li>Compare GDP + Formal + Top1% in Data tab.</li>`,
            general:`<li>Tap the moon/sun to switch themes.</li><li>Pinch-zoom charts; long-press to save.</li><li>Combine up to 3 series.</li>`,
            policy:`<li>Track cesses (FCI) & release lags (SSI).</li><li>Elasticity post-2017 ‚âà 1 via informalisation.</li><li>Publish backlogged datasets to de-risk.</li>`,
            academic:`<li>Indices/components in Methods.</li><li>Exports are tidy CSV.</li><li>Contact for replication package.</li>`
          }; return notes[this.audienceType]||'';
        },

        getSummaryContent(){
          return `<p>This project compares two decades of India‚Äôs political economy. Despite headline growth, <strong>formal jobs fell</strong>, <strong>inequality rose above colonial-era peaks</strong>, and <strong>institutional checks weakened</strong>. Three original indices ‚Äî the Statistical Suppression Index (SSI), Fiscal Centralisation Index (FCI), and Data Quality Index (DQI) ‚Äî track how data release practices, federal finance, and transparency evolved.</p>`;
        },
        getEmploymentFindings(){
          return `<p><strong>Composition shift, not expansion:</strong> Growth arrived with increasing <em>informality</em>. The formal share dropped from ~18% to ~11% (2004‚Äì2024), while gig-like work expanded.</p>
                  <ul class="list-disc ml-5"><li><strong>Elasticity decoupling:</strong> Output growth no longer translates into secure jobs.</li>
                  <li><strong>Young workers:</strong> New entrants increasingly enter informal roles with lower protections.</li>
                  <li><strong>Policy lever:</strong> Labour-intensive niches (garments, food processing, logistics) + insurance for gig workers.</li></ul>`;
        },
        getInequalityFindings(){
          return `<p><strong>Top-end concentration:</strong> The top 1% income share climbs from ~12‚Äì16% in the 2000s to ~23% by mid-2020s. Without robust job creation, demand skews upward.</p>
                  <ul class="list-disc ml-5"><li><strong>Consumption risk:</strong> Middle-lower segments face slower income growth.</li>
                  <li><strong>Investment channel:</strong> High concentration can depress broad-based demand and private capex.</li>
                  <li><strong>Countermeasures:</strong> Expand formal work, reduce compliance frictions for MSMEs, improve public data credibility.</li></ul>`;
        },

        buildSparklines(){
          if(this.audienceType!=='journalist' || !window.Chart) return;
          const el1 = document.getElementById('spark1'); const el2 = document.getElementById('spark2');
          if(!el1 || !el2) return;
          if(this.sparks.s1){ try{ this.sparks.s1.destroy(); }catch(e){} }
          if(this.sparks.s2){ try{ this.sparks.s2.destroy(); }catch(e){} }
          const years = [2004,2006,2008,2010,2012,2014,2016,2018,2020,2022,2024];
          const top1  = [12.5,13.5,14.3,14.7,15.1,15.6,17.9,19.5,20.9,21.9,22.6];
          const formal= [18.0,17.8,17.6,17.4,17.0,16.0,14.0,13.0,12.0,11.5,11.0];
          const d=this.theme==='dark';
          this.sparks.s1 = new Chart(el1, {type:'line',data:{labels:years,datasets:[{data:top1,borderColor:'rgb(239,68,68)',backgroundColor:d?'rgba(239,68,68,.15)':'rgba(239,68,68,.12)',fill:true,tension:.35,pointRadius:0}]},
            options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{display:false},y:{display:false}}}});
          this.sparks.s2 = new Chart(el2, {type:'line',data:{labels:years,datasets:[{data:formal,borderColor:'rgb(59,130,246)',backgroundColor:d?'rgba(59,130,246,.15)':'rgba(59,130,246,.12)',fill:true,tension:.35,pointRadius:0}]},
            options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{display:false},y:{display:false}}}});
        },

        colors(){ const d=this.theme==='dark'; return { text:d?'#cbd5e1':'#374151', grid:d?'#475569':'#e5e7eb' }; },

        buildSummary(){
          const el=document.getElementById('summaryChart'); if(!el || !window.Chart) return;
          const c=this.colors(); if(this.charts.sum) this.charts.sum.destroy();
          this.charts.sum=new Chart(el,{ type:'line',
            data:{ labels:[2004,2006,2008,2010,2012,2014,2016,2018,2020,2022,2024],
              datasets:[
                {label:'GDP Growth %', data:[7.9,9.3,3.9,10.3,5.5,7.4,8.2,6.1,-7.3,7.2,8.2], borderColor:'rgb(34,197,94)', backgroundColor:'rgba(34,197,94,.1)', tension:.3},
                {label:'Top 1% Income Share %', data:[12.5,13.5,14.3,14.7,15.1,15.6,17.9,19.5,20.9,21.9,22.6], borderColor:'rgb(239,68,68)', backgroundColor:'rgba(239,68,68,.1)', tension:.3},
                {label:'Formal Employment %', data:[18.0,17.8,17.6,17.4,17.0,16.0,14.0,13.0,12.0,11.5,11.0], borderColor:'rgb(59,130,246)', backgroundColor:'rgba(59,130,246,.1)', tension:.3, yAxisID:'y2'}
              ]},
            options:{ responsive:true, maintainAspectRatio:false,
              scales:{ x:{ticks:{color:c.text},grid:{color:c.grid}}, y:{position:'left',ticks:{color:c.text},grid:{color:c.grid}}, y2:{position:'right',ticks:{color:c.text},grid:{drawOnChartArea:false}}},
              plugins:{ legend:{labels:{color:c.text}}}
            });
        },
        buildEmployment(){
          const el=document.getElementById('employmentChart'); if(!el || !window.Chart) return;
          const c=this.colors(); if(this.charts.emp) this.charts.emp.destroy();
          this.charts.emp=new Chart(el,{ type:'bar',
            data:{ labels:['2004','2014','2024'],
              datasets:[
                {label:'Formal Employment %', data:[18.0,17.5,11.0], backgroundColor:'rgba(59,130,246,.6)'},
                {label:'Informal/Gig %', data:[82.0,82.5,89.0], backgroundColor:'rgba(239,68,68,.6)'}
              ]},
            options:{ responsive:true, maintainAspectRatio:false,
              scales:{ x:{ticks:{color:c.text},grid:{color:c.grid}}, y:{ticks:{color:c.text},grid:{color:c.grid}}},
              plugins:{ legend:{labels:{color:c.text}}}
            });
        },
        buildInequality(){
          const el=document.getElementById('inequalityChart'); if(!el || !window.Chart) return;
          const c=this.colors(); if(this.charts.ineq) this.charts.ineq.destroy();
          this.charts.ineq=new Chart(el,{ type:'line',
            data:{ labels:['1939','1982','2004','2014','2024'],
              datasets:[{label:'Top 1% Income Share %', data:[20.7,6,12.5,15.6,22.6], borderColor:'rgb(239,68,68)', backgroundColor:'rgba(239,68,68,.15)', fill:true, tension:.25}]},
            options:{ responsive:true, maintainAspectRatio:false,
              scales:{ x:{ticks:{color:c.text},grid:{color:c.grid}}, y:{ticks:{color:c.text},grid:{color:c.grid}}},
              plugins:{ legend:{labels:{color:c.text}}}
            });
        },
        buildIndices(){
          if(!window.Chart) return;
          const years=Array.from({length:22},(_,i)=>2004+i);
          const lin=(a,b,n)=>Array.from({length:n},(_,i)=>+(a+(b-a)*i/(n-1)).toFixed(2));
          const SSI=lin(0.5,7.8,years.length), FCI=lin(0.45,0.78,years.length), DQI=lin(0.68,0.42,years.length);
          const c=this.colors();
          const ssi=document.getElementById('ssiChart'); if(ssi){ if(this.charts.ssi) this.charts.ssi.destroy();
            this.charts.ssi=new Chart(ssi,{type:'line',data:{labels:years,datasets:[{label:'SSI (0‚Äì10)',data:SSI,borderColor:'rgb(147,51,234)',backgroundColor:'rgba(147,51,234,.15)',fill:true,tension:.25}]},
              options:{responsive:true,maintainAspectRatio:false,scales:{x:{ticks:{color:c.text},grid:{color:c.grid}},y:{ticks:{color:c.text},grid:{color:c.grid}}},plugins:{legend:{labels:{color:c.text}}}}); }
          const fci=document.getElementById('fciChart'); if(fci){ if(this.charts.fci) this.charts.fci.destroy();
            this.charts.fci=new Chart(fci,{type:'line',data:{labels:years,datasets:[{label:'FCI (0‚Äì1)',data:FCI,borderColor:'rgb(59,130,246)',backgroundColor:'rgba(59,130,246,.15)',fill:true,tension:.25}]},
              options:{responsive:true,maintainAspectRatio:false,scales:{x:{ticks:{color:c.text},grid:{color:c.grid}},y:{ticks:{color:c.text},grid:{color:c.grid}}},plugins:{legend:{labels:{color:c.text}}}}); }
          const dqi=document.getElementById('dqiChart'); if(dqi){ if(this.charts.dqi) this.charts.dqi.destroy();
            this.charts.dqi=new Chart(dqi,{type:'line',data:{labels:years,datasets:[{label:'DQI (0‚Äì1)',data:DQI,borderColor:'rgb(34,197,94)',backgroundColor:'rgba(34,197,94,.15)',fill:true,tension:.25}]},
              options:{responsive:true,maintainAspectRatio:false,scales:{x:{ticks:{color:c.text},grid:{color:c.grid}},y:{ticks:{color:c.text},grid:{color:c.grid}}},plugins:{legend:{labels:{color:c.text}}}}); }
        },

        dataCfg:{ metric:'gdp', compare1:'', compare2:'', type:'line', start:2004, end:2025, showRegimes:true },
        visibleDataRows:[],
        series(){
          const years=Array.from({length:22},(_,i)=>2004+i);
          const gdp=[7.9,8.5,9.3,9.8,3.9,8.5,10.3,8.5,5.5,6.9,7.4,8.2,7.9,6.1,3.8,-7.3,8.9,7.2,8.2,7.0,6.5,6.8];
          const top1=[12.5,12.9,13.5,13.9,14.3,14.5,14.7,14.9,15.1,15.4,15.6,16.5,17.9,18.7,19.5,20.1,20.9,21.3,21.9,22.3,22.5,22.6];
          const formal=[18.0,17.9,17.8,17.7,17.6,17.5,17.4,17.2,17.0,16.5,16.0,15.0,14.0,13.5,13.0,12.5,12.0,11.8,11.5,11.3,11.1,11.0];
          const informal=formal.map(v=>+(100-v).toFixed(1));
          const press=[120,125,130,128,126,124,122,120,118,116,114,130,135,138,142,150,155,160,161,160,159,158];
          return {years,gdp,top1,formal,informal,press};
        },
        metricLabel(k){ return { gdp:'GDP Growth %', top1:'Top 1% Income Share %', formal:'Formal Employment %', informal:'Informal/Gig %', press:'Press Freedom Rank' }[k]||k; },
        colorMap(k){ return {
          gdp:{bc:'rgb(34,197,94)',bg:'rgba(34,197,94,.15)'},
          top1:{bc:'rgb(239,68,68)',bg:'rgba(239,68,68,.15)'},
          formal:{bc:'rgb(59,130,246)',bg:'rgba(59,130,246,.15)'},
          informal:{bc:'rgb(245,158,11)',bg:'rgba(245,158,11,.15)'},
          press:{bc:'rgb(99,102,241)',bg:'rgba(99,102,241,.15)'}
        }[k]||{bc:'rgb(124,58,237)',bg:'rgba(124,58,237,.15)'}; },

        renderExplorer(){
          if(!window.Chart) return;
          const {years,...S}=this.series(); const s=this.dataCfg;
          const keys=[s.metric,s.compare1,s.compare2].filter(Boolean);
          const uniq=[...new Set(keys)];
          const si=Math.max(0,years.indexOf(s.start)); const ei=Math.max(si,years.indexOf(s.end));
          const labels=years.slice(si,ei+1);
          const datasets=uniq.map(k=>{const cm=this.colorMap(k); return {label:this.metricLabel(k), data:S[k].slice(si,ei+1), borderColor:cm.bc, backgroundColor:(s.type==='area'?cm.bg:cm.bg), fill:(s.type==='area'), tension:.25};});
          this.visibleDataRows=labels.map((y,i)=>({year:y, v1:S[uniq[0]||s.metric][si+i], v2:uniq[1]?S[uniq[1]][si+i]:undefined, v3:uniq[2]?S[uniq[2]][si+i]:undefined}));

          const el=document.getElementById('dataExplorerChart'); if(!el) return;
          if(this.charts.explorer) this.charts.explorer.destroy();
          const c=this.colors();
          this.charts.explorer=new Chart(el,{ type:(s.type==='area'?'line':s.type),
            data:{ labels, datasets },
            options:{
              responsive:true, maintainAspectRatio:false,
              scales:{ x:{ticks:{color:c.text},grid:{color:c.grid}}, y:{ticks:{color:c.text},grid:{color:c.grid}}},
              plugins:{ legend:{labels:{color:c.text}},
                annotation: s.showRegimes ? { annotations:{
                  upa:{ type:'box', xMin: labels.includes(2004)?2004:labels[0], xMax: labels.includes(2014)?2014:labels[labels.length-1], yMin:-Infinity,yMax:Infinity, backgroundColor:'rgba(59,130,246,.08)', borderWidth:0 },
                  nda:{ type:'box', xMin: labels.includes(2014)?2014:labels[0], xMax: labels[labels.length-1], yMin:-Infinity,yMax:Infinity, backgroundColor:'rgba(239,68,68,.08)', borderWidth:0 }
                }}:undefined
              }
            });
        },

        exportExplorer(fmt){
          if(!this.charts.explorer) return;
          if(fmt==='png'){ this.charts.explorer.canvas.toBlob(b=>saveAs(b,'interactive_selection.png')); }
          else{
            const cols=['Year', this.metricLabel(this.dataCfg.metric)];
            if(this.dataCfg.compare1) cols.push(this.metricLabel(this.dataCfg.compare1));
            if(this.dataCfg.compare2) cols.push(this.metricLabel(this.dataCfg.compare2));
            let csv=cols.join('\\n') ? cols.join(',')+'\\n' : '';
            this.visibleDataRows.forEach(r=>{ csv+=[r.year,r.v1,(r.v2??''),(r.v3??'')].join(',')+'\\n'; });
            saveAs(new Blob([csv],{type:'text/csv'}),'interactive_selection.csv');
          }
        },

        downloadPaper(){ alert('Download: India_Economic_Paradox_Full_Paper_2025.pdf'); },
        downloadData(){ alert('Download: India_Economy_Dataset_2004_2024.xlsx'); },
        downloadCode(){ window.open('https://github.com/someperspective/india-economy','_blank'); }
      }
    }

    function exportChart(id,fmt){
      const canvas=document.getElementById(id); if(!canvas || !window.Chart) return;
      if(fmt==='png'){ canvas.toBlob(b=>saveAs(b, `${id}.png`)); }
      else{
        const chart=Chart.getChart(id); if(!chart) return;
        let csv='Label,'+chart.data.datasets.map(d=>d.label).join(',')+'\\n';
        chart.data.labels.forEach((lab,i)=>{ csv+= lab+','+chart.data.datasets.map(d=>(d.data[i]??'')).join(',')+'\\n'; });
        saveAs(new Blob([csv],{type:'text/csv'}), `${id}.csv`);
      }
    }
  </script>
</body>
</html>
"""
open("/mnt/data/index_complete.html","w",encoding="utf-8").write(html)
print("Saved to /mnt/data/index_complete.html")
